<h5 id="start"></h5>

### 請求書

<aside>
💡 高品質な請求書をデザインするためには、一連の慎重な手順を踏む必要があります。以下は、効率的かつ専門的に請求書のデザインを完了するための詳細なガイドです。
</aside>
<br>

#### **一. デザイナーを開く**

eDocument DXタブのクイックスタートまたは新しいテンプレートデータの作成からデザイナーを開きます。

![リクエストフォーム_デザイナーを開く](../_images/jp/リクエストフォーム_デザイナーを開く.png)

#### **二. テンプレートを選択**

ﾃﾝﾌﾟﾚｰﾄ ｻﾝﾌﾟﾙから請求書テンプレートを選択し、[確定]をクリックしてデザイナーに読み込みます。

![リクエストフォーム_テンプレートを選択](../_images/jp/リクエストフォーム_テンプレートを選択.gif)

<h4 id="step3"></h4>

#### **三. 編集と最適化**
> （1）全体レイアウトの調整

> **1. フォント：**

要件に応じて適切な全体フォントを選択します。特殊なニーズを満たすために[フォントカスタマイズ](ad-customFont.md#start)を選択することもできます。

![リクエストフォーム_編集と最適化_フォント](../_images/jp/リクエストフォーム_編集と最適化_フォント.gif)

> **2. ページ番号の書式：**
要件に応じてページ番号の書式をカスタマイズします。例：`${paperNo}-${paperCount}ページ`など。

![リクエストフォーム_編集と最適化_ページ番号の形式](../_images/jp/リクエストフォーム_編集と最適化_ページ番号の形式.gif) 

> （2）テキスト要素の調整

> **1. データ型とフォーマット：**

- テキスト要素のデータ型を指定し、要件に応じて適切なフォーマットを選択します。
- デザイナーには豊富なデータフォーマットが提供されていますが、カスタムデータフォーマットを入力して特殊なニーズを満たすこともできます。

![リクエストフォーム_編集と最適化_データ型と形式](../_images/jp/リクエストフォーム_編集と最適化_データ型と形式.gif)

> **2. フォントスタイル：**

フォントサイズ、太さ、色、字間を調整して、テキストの可読性と美観を向上させます。

![リクエストフォーム_編集と最適化_フォントスタイル](../_images/jp/リクエストフォーム_編集と最適化_フォントスタイル.png)

> （3）テーブル要素の調整

> **1. フィールド名：**

- フィールド名はデータソースのフィールドと接続するために使用されます。
- フィールド名を設定した後、モックデータにサンプルデータを入力して、プレビュー時に表データが正しく表示されることを確認します。
- <mark>**注意**</mark>：テーブルのモックデータはJSONフォーマットを使用してください。

![リクエストフォーム_テーブル要素の調整_フィールド名](../_images/jp/リクエストフォーム_テーブル要素の調整_フィールド名.gif)

> **2. 背景と罫線の色：**

ヘッダー、ボディの奇数行と偶数行、および罫線の色をそれぞれ設定して視覚効果を強化します。

![リクエストフォーム_テーブル要素の調整_背景色と枠線の色](../_images/jp/リクエストフォーム_テーブル要素の調整_背景色と枠線の色.png)

> **3. 罫線のスタイル：**

ボディ行の罫線とボディセルの罫線を点線に設定できます。ボディ行の罫線設定はボディ内の行罫線を点線にし、ボディセルの罫線設定はボディ内の列罫線を点線にします。

![リクエストフォーム_テーブル要素の調整_枠線スタイル](../_images/jp/リクエストフォーム_テーブル要素の調整_枠線スタイル.gif)

> （4）テーブルの列要素の調整

> **1. フィールドタイプ：**

セルに適切なフィールドタイプ（テキスト、数値、日付/時間、番号、バーコード、QRコード、画像）を設定できます。また、異なるタイプに応じてフォーマット方法を設定できます。例えば、数値や日付/時間に対して、既存のフォーマットを選択するほかに、カスタムフォーマットを入力することもできます。

- 番号、テキスト：

![リクエストフォーム_テーブル列要素の調整_フィールドタイプ_番号、テキスト](../_images/jp/リクエストフォーム_テーブル列要素の調整_フィールドタイプ_番号、テキスト.gif)

- 数値、日付/時間：

![リクエストフォーム_テーブル列要素の調整_フィールドタイプ_数値、日時](../_images/jp/リクエストフォーム_テーブル列要素の調整_フィールドタイプ_数値、日時.gif)

- バーコード、QRコード：

![リクエストフォーム_テーブル列要素の調整_フィールドタイプ_バーコード、QRコード](../_images/jp/リクエストフォーム_テーブル列要素の調整_フィールドタイプ_バーコード、QRコード.gif)

- 画像：

![リクエストフォーム_テーブル列要素の調整_フィールドタイプ_画像](../_images/jp/リクエストフォーム_テーブル列要素の調整_フィールドタイプ_画像.gif)

> **2. セルの高さ：**

表に特殊なタイプの列（QRコード、バーコード、画像）が含まれている場合、これらの列のセルの高さを個別に設定できます。設定後、QRコード、バーコード、画像は設定したセルの高さに従って表示されます。<br/>
- <mark>**注意**</mark>：QRコードやバーコードが中央に表示されるようにするため、セルの高さは表体の行高より小さくしてください。

![リクエストフォーム_セルの高さ](../_images/jp/リクエストフォーム_セルの高さ.gif)

> **3. フッター集計設定：**

- 集計タイトル：表示を選択すると、集計内容がテーブルの下部に表示されます。
- 集計テキスト：特定の列の集計結果のテキスト説明を定義し、ユーザーが集計結果の意味を迅速に理解できるようにします。
- 集計の結合列数：現在の列から開始して集計結果を表示するために結合する列の数を決定します。
- 集計のﾀｲﾌﾟ：特定の列の集計計算タイプ（合計、平均値など）を選択し、さまざまな統計ニーズを満たします。
- 集計の左右揃え：集計結果のテキスト整列方法を設定します（例：左揃え、右揃え）。
- 集計の小数点桁数：必要に応じて集計結果に表示する小数点以下の桁数を設定し、データの正確性と可読性を確保します。

![リクエストフォーム_フッター集計設定](../_images/jp/リクエストフォーム_フッター集計設定.gif)

<h4 id="step4"></h4>

#### **四. デザイナーのプレビューと保存**

> **1. JSONデータﾓﾃﾞﾙの表示：**

- [JSONデータﾓﾃﾞﾙの表示]ボタンをクリックして、テンプレートのフィールド名のJSONマッピングを確認します。
- データ（JSONフォーマット）を[モックデータ編集]に貼り付け、[プレビュー]をクリックして実際の効果を確認します。

![リクエストフォーム_デザイナープレビューと保存_プレビュー](../_images/jp/リクエストフォーム_デザイナープレビューと保存_プレビュー.gif)

> **2. テンプレートを保存する：**

左上にテンプレート名を入力し、[保存]ボタンをクリックして現在のテンプレートを保存します。

![リクエストフォーム_デザイナープレビューと保存_保存](../_images/jp/リクエストフォーム_デザイナープレビューと保存_保存.gif)

<h4 id="step5"></h4>

#### **五. 実際のプレビュー、印刷、およびPDFのエクスポート**

> **1. データモデルの抽出**

1.1 [Apex Classデータﾓﾃﾞﾙの表示]ボタンをクリックして、テンプレートのフィールドのApexクラスコードを表示します。

![リクエストフォーム_データモデル抽出_コードのコピー](../_images/jp/リクエストフォーム_データモデル抽出_コードのコピー.gif)

1.2 Salesforceで新しいApexクラスファイルを作成し、コピーしたコードをファイルに貼り付けます。テンプレートに関連するデータモデルを保存するために使用されます。

![リクエストフォーム_データモデル抽出_Classの作成](../_images/jp/リクエストフォーム_データモデル抽出_Classの作成.gif)

> **2. データソース設定**

2.1 アプリケーションを開き、[データソース設定]を選択し、[新規]ボタンをクリックします。

![リクエストフォーム_データソース設定_新規作成](../_images/jp/リクエストフォーム_データソース設定_新規作成.png)

2.2 まず、主オブジェクトを設定します。これは通常データの主体またはコアです。次に、必要に応じて子オブジェクトを設定します。これらは主オブジェクトと関連付けられた二次データです。

![リクエストフォーム_データソース設定_主テーブル、子テーブル](../_images/jp/リクエストフォーム_データソース設定_主テーブル、子テーブル.gif)

2.3 前にデザイナーで保存した請求書テンプレートを選択します。

![リクエストフォーム_データソース設定_テンプレートを選択](../_images/jp/リクエストフォーム_データソース設定_テンプレートを選択.gif)

2.4 データソースのフィールドをテンプレートのフィールドにマッピングします。

![リクエストフォーム_データソース設定_フィールドマッピング](../_images/jp/リクエストフォーム_データソース設定_フィールドマッピング.gif)

2.5 [保存してデザイン画面に遷移]をクリックし、デザイナーページで[プレビュー]をクリックしてデータソースのバインドが成功したかどうかを確認します。

![リクエストフォーム_データソース設定_保存プレビュー](../_images/jp/リクエストフォーム_データソース設定_保存プレビュー.gif)

> **3. アクション設定**

3.1 アプリケーションを開き、[アクション設定]を選択し、[新規]ボタンをクリックします。

![リクエストフォーム_Action設定_新規作成](../_images/jp/リクエストフォーム_Action設定_新規作成.png)

3.2 情報を設定します：
- テンプレート名は【4. デザイナーのプレビューと保存】-> ステップ2のテンプレートを選択します。
- 機能設定のボタンタイプで「詳細ページボタン」を選択。
- [プレビュー内容を表示]にチェックを入れます。
- 使用する機能を選択し、[プリンター印刷]および[PDFダウンロード]を選択します。
- Apexクラス名を入力します。
- 印刷設定の「印刷サービス設定」では、クラウド印刷サービスまたはローカル印刷サービスを選択できます。「デバイス番号」は印刷サービスの機械コードとして設定します。

![リクエストフォーム_Action設定_設定情報](../_images/jp/リクエストフォーム_Action設定_設定情報.png)

3.3 [保存]をクリックすると、システムはApexクラスとVisualforceページのサンプルコードを生成します。

![リクエストフォーム_Action設定_保存](../_images/jp/リクエストフォーム_Action設定_保存.png)

> **4. Visualforceページの作成**

4.1 右側の説明に従って、Salesforceで新しいVisualforceページファイルを作成します。

![リクエストフォーム_Visualforceページの作成_VFページの作成](../_images/jp/リクエストフォーム_Visualforceページの作成_VFページの作成.gif)

> **5. プレビューボタンの設定**

5.1 印刷が必要なSalesforceオブジェクトにボタンを追加し、オブジェクトページでボタンが表示されることを確認します。

![リクエストフォーム_プレビューボタンの設定_作成](../_images/jp/リクエストフォーム_プレビューボタンの設定_作成.gif)

5.2 オブジェクトページで、ボタンが表示されることを確認します。

![リクエストフォーム_プレビューボタンの設定_ボタンの可視性](../_images/jp/リクエストフォーム_プレビューボタンの設定_ボタンの可視性.gif)

> **6. プレビューと操作**

6.1 ビジネスオブジェクトの詳細データページで、プレビューボタンをクリックしてデータを含むテンプレートのプレビューを確認し、データが正しく表示されていることを確認します。

![リクエストフォーム_プレビューと操作_プレビュー](../_images/jp/リクエストフォーム_プレビューと操作_プレビュー.gif)

6.2 [print]ボタンをクリックして、テンプレートとデータを一緒に印刷します（印刷クライアントが接続されていることを確認してください）。
- <mark>**注意**</mark>：印刷には印刷クライアントが接続されている必要があります。接続されていない場合は、[印刷端末](download.md)を参照してください。

6.3 [PDF]ボタンをクリックして、テンプレートとデータをPDFファイルとしてエクスポートします。

![リクエストフォーム_プレビューと操作_PDF](../_images/jp/リクエストフォーム_プレビューと操作_PDF.gif)