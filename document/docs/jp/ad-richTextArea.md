<h5 id="start"></h5>

### リッチテキスト内容の印刷

<aside>
💡 リッチテキスト内容の印刷機能を使用すると、レポートデザイン時にリッチテキストの内容を簡単に印刷データに埋め込むことができ、印刷プレビュー時にHTML形式で自動的に表示されます。HTMLコードをリッチテキストボックスにバインドすることで、システムはこれらのコードに含まれる書式（ハイパーリンク、斜体、色など）を自動的に解析して表示します。HTMLデータを処理する際は、すべての二重引用符を単一引用符に置き換えるか、占位符amp;quot;を使用して解析の衝突を回避するようにしてください。
</aside>
<br>

#### **実例説明：**
あなたは注文テンプレートをデザインしており、このテンプレートには注文番号、顧客情報、配送先住所、商品リストなどの注文詳細を表示する必要があります。特に商品説明は、太字、斜体、色などのリッチテキスト形式を含み、商品ページのリンクを埋め込む必要があります。リッチテキスト内容の印刷機能を使用することで、HTML形式の商品説明を直接テンプレートに埋め込むことができ、印刷プレビュー時に最適な効果で表示されることを保証します。これにより、顧客は印刷された注文書を受け取った際に、商品詳細を直感的に理解し、リンクをクリックして詳細情報を確認することができます。

#### **1. デザイナーを開く**

> eDocument DXタブのクイックスタートまたは新しいテンプレートデータの作成からデザイナーを開きます。

#### **2. 新しいテンプレートを作成する**

> HTML要素をパネルにドラッグ＆ドロップします。

![リッチテキスト内容の印刷_新しいテンプレートを作成する](../_images/jp/リッチテキスト内容の印刷_新しいテンプレートを作成する.gif)

#### **3. HTMLのフィールド属性を設定する**

> HTMLのフィールド名を設定します。

![リッチテキスト内容の印刷_HTMLのフィールド属性を設定する](../_images/jp/リッチテキスト内容の印刷_HTMLのフィールド属性を設定する.gif)

#### **4. フォーマット関数の設定**

> HTML要素を選択し、そのプロパティパネルを開き、[詳細]タブに切り替えます。<br/>

> [フォーマット関数]入力欄をクリックして、関数ウィンドウを開きます。AIを利用してフォーマット関数を生成する方法または自分で作成する方法（詳細は<a href="/#/jp/ad-highlevel.md#self-format1" target="_blank">フォーマット関数</a>の説明を参照）で関数を作成します。

![リッチテキスト内容印刷_フォーマット関数の設定](../_images/jp/リッチテキスト内容印刷_フォーマット関数の設定.gif)

#### 5. カスタムコードの作成
> 5.1 サンプルコードのロジック：
```
function formatter(value, options, templateData) {
  return ` 
    <body style="font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; background-color: #f9f9f9; color: #333;">
        <h1 style="color: #FF6347;">りんご</h1>
        <div style="font-size: 1.1em; margin-bottom: 20px;">
            <p>りんごは非常に人気のある果物で、その<em>おいしさ</em>と<em>健康</em>特性から広く愛されています。ビタミンが豊富であるだけでなく、<em style="color: #FF4500;">抗酸化</em>および<em style="color: #FF4500;">抗がん</em>効果もあります。</p>
            <p>りんごに関する詳細情報を知りたい方は、以下のリンクをクリックしてください：</p>
            <a href="https://e-cloudsoft2-dev-ed.develop.lightning.force.com/lightning/r/Product2/01tGB00000DSHDXYA5/view" target="_blank" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background-color: #FF6347; color: white; text-decoration: none; border-radius: 5px;">詳細を確認する</a>
        </div>
        <img src="https://sad-sunflower.github.io/work/testImage/apple.png" alt="りんごの画像" style="max-width: 100%; height: auto; border-radius: 10px; margin-top: 20px;">
    </body>`;
}
```

> 5.2 コードブロックを「フォーマット関数」の右側の関数コードエリアにコピーし、「確認」ボタンをクリックして設定を保存します。

![リッチテキストコンテンツの印刷_カスタムコードの作成_コードのコピー](../_images/jp/リッチテキストコンテンツの印刷_カスタムコードの作成_コードのコピー.png)

> 5.3 「プレビュー」をクリックして効果を確認します。

![リッチテキストコンテンツの印刷_カスタムコードの作成_プレビュー](../_images/jp/リッチテキストコンテンツの印刷_カスタムコードの作成_プレビュー.gif)

#### **6. テンプレートを保存する**

> デザインが完了したら、左上の入力欄にテンプレート名を入力し、保存ボタンをクリックするか、ショートカットキー（Ctrl / Command + S）を使用してテンプレートを保存します。

![リッチテキスト内容の印刷_テンプレートを保存する](../_images/jp/リッチテキスト内容の印刷_テンプレートを保存する.gif)

#### **7. テンプレートの表示と管理**

> テンプレートタブで、「最近表示されたデータ（固定リスト）」を「全選択」に変更すると、保存されたすべてのテンプレートを表示でき、編集や削除などの操作ができます。

![リッチテキスト内容の印刷_テンプレートの表示と管理](../_images/jp/リッチテキスト内容の印刷_テンプレートの表示と管理.gif)