<h5 id="start"></h5>

### 请求书

<aside>
💡 设计一份高质量的请求书，需要遵循一系列精心的步骤。以下是一个详尽的指南，帮助您高效、专业地完成请求书的设计。
</aside>
<br>

#### **一. 打开设计器**

通过eDocument DX Tab的快速开始或新建模板数据的方式打开设计器。

![请求书_打开设计器](../_images/zh-cn/请求书_打开设计器.png)

#### **二. 选择模板**

从模板中心选择请求书模板并点击确定，以加载该模板到设计器中。

![请求书_选择模板](../_images/zh-cn/请求书_选择模板.gif)

<h4 id="step3"></h4>

#### **三. 编辑与优化**
> （一）调整整体布局

> **1. 字体：**

根据需求选择合适的全局字体，您也可以选择[自定义字体](ad-customFont.md#start)以满足特殊需求。

![请求书_编辑与优化_字体](../_images/zh-cn/请求书_编辑与优化_字体.gif)

> **2. 页码格式：**
根据需求自定义页码显示的格式，如`${paperNo}-${paperCount}页`等。

![请求书_编辑与优化_页码格式](../_images/zh-cn/请求书_编辑与优化_页码格式.gif)

> （二）调整文本元素

> **1. 数据类型与格式：**

- 指定文本元素的数据类型，并根据需求选择合适的格式。
- 设计器提供了丰富的数据格式，您也可以输入自定义数据格式以满足特殊需求。

![请求书_编辑与优化_数据类型与格式](../_images/zh-cn/请求书_编辑与优化_数据类型与格式.gif)

> **2. 字体样式：**

调整字体大小、粗细、颜色和字间距，提升文本的可读性和美观性。

![请求书_编辑与优化_字体样式](../_images/zh-cn/请求书_编辑与优化_字体样式.png)

> （三）调整表格元素

> **1. 字段名：**

- 字段名用于与数据源中的字段建立连接。
- 设置好字段名后，您可以在测试数据中输入示例数据，确保预览时能够正确展示表格的数据。
- <mark>**注意**</mark>：表格的测试数据应采用JSON格式。

![请求书_调整表格元素_字段名](../_images/zh-cn/请求书_调整表格元素_字段名.gif)

> **2. 背景与边框颜色：**

分别设定表头、表体奇偶行以及表格边框的颜色，增强视觉效果。

![请求书_调整表格元素_背景与边框颜色](../_images/zh-cn/请求书_调整表格元素_背景与边框颜色.png)

> **3. 边框样式：**

您可以设定表体行边框和表体单元格边框为虚线。表体行边框的设置会使表体内部的行边框显示为虚线，而表体单元格边框的设置则会使表体内部的列边框显示为虚线。

![请求书_调整表格元素_边框样式](../_images/zh-cn/请求书_调整表格元素_边框样式.gif)

> （四）调整表格列元素

> **1. 字段类型：**

您可以为单元格设定合适的字段类型，包括：文本、数值、日期时间、序号、条形码、二维码和图片。同时，针对不同类型，您还可以设置相应的格式化方式。比如，对于数值和日期时间，除了选择已有的格式，还可以输入自定义的格式。

- 序号、文本：

![请求书_调整表格列元素_字段类型_序号、文本](../_images/zh-cn/请求书_调整表格列元素_字段类型_序号、文本.gif)

- 数值、日期时间：

![请求书_调整表格列元素_字段类型_数值、日期时间](../_images/zh-cn/请求书_调整表格列元素_字段类型_数值、日期时间.gif)

- 条形码、二维码：

![请求书_调整表格列元素_字段类型_条形码、二维码](../_images/zh-cn/请求书_调整表格列元素_字段类型_条形码、二维码.gif)

- 图片：

![请求书_调整表格列元素_字段类型_图片](../_images/zh-cn/请求书_调整表格列元素_字段类型_图片.gif)

> **2. 单元格高度：**

当表格包含特殊类型列（如二维码、条形码、图片）时，可单独设置这些列的单元格高度。一旦设定，二维码、条形码和图片将按照您设定的单元格高度展示。<br/>
- <mark>**注意**</mark>：为确保二维码和条形码居中显示，单元格高度应小于表体行高。

![请求书_单元格高度](../_images/zh-cn/请求书_单元格高度.gif)

> **3. 底部聚合设置：**

- 底部聚合标题：当选择"显示"时，底部聚合的内容将会展现在表格下方。
- 底部聚合文本：定义表格指定列聚合结果的文本描述，如"平均值："，以便用户快速理解聚合结果的含义。
- 底部聚合合并列数：决定从当前列开始向后合并多少列来展示聚合结果。
- 底部聚合类型：选择表格指定列的聚合计算类型，如合计、平均值等，以满足不同统计需求。
- 底部聚合类型左右对齐：设置聚合结果的文本对齐方式，如居左、居右等。
- 底部聚合小数：根据需要设置聚合结果中保留的小数位数，确保数据的准确性和可读性。

![请求书_底部聚合设置](../_images/zh-cn/请求书_底部聚合设置.gif)

<h4 id="step4"></h4>

#### **四. 设计器预览与保存**

> **1. 查看JSON数据模型：**

- 点击"查看JSON数据模型"按钮查看模板中字段名的JSON映射。
- 将数据（JSON格式）粘贴至"编辑测试数据"中，点击"预览"查看实际效果。

![请求书_设计器预览与保存_预览](../_images/zh-cn/请求书_设计器预览与保存_预览.gif)

> **2. 保存模板：**

在左上角输入模板名称后，点击"保存"按钮保存当前的模板。

![请求书_设计器预览与保存_保存](../_images/zh-cn/请求书_设计器预览与保存_保存.gif)

<h4 id="step5"></h4>

#### **五. 实际预览、打印与导出PDF**

> **1. 数据模型抽取**

1.1 点击"查看Apex Class数据模型"按钮，显示模板中字段的Apex类代码。

![请求书_数据模型抽取_复制代码](../_images/zh-cn/请求书_数据模型抽取_复制代码.gif)

1.2 在Salesforce中新建一个Apex Class文件，将1.1复制的代码粘贴到文件中。用于存储与模板相关的数据模型。

![请求书_数据模型抽取_创建Class](../_images/zh-cn/请求书_数据模型抽取_创建Class.gif)

> **2. 数据源配置**

2.1 打开应用，选择"数据源设定"，点击"新建"按钮。

![请求书_数据源配置_新建](../_images/zh-cn/请求书_数据源配置_新建.png)

2.2 首先设定主对象，这通常是数据的主体或核心。接着，根据需要设定子对象，这些是与主对象相关联的次级数据。

![请求书_数据源配置_主表、子表](../_images/zh-cn/请求书_数据源配置_主表、子表.gif)

2.3 选择之前设计器保存的请求书模版。

![请求书_数据源配置_选择模板](../_images/zh-cn/请求书_数据源配置_选择模板.gif)

2.4 将数据源中的字段与模板中的字段进行映射。

![请求书_数据源配置_字段映射](../_images/zh-cn/请求书_数据源配置_字段映射.gif)

2.5 点击"保存并跳转到设计页面"，在设计器页面点击"编辑测试数据"选择一笔想要预览查看的数据，点击表格中数据对应的应用后再次点击右下角的应用保存数据，此时点击"预览"查看数据源绑定成功的效果。

![请求书_数据源配置_保存预览](../_images/zh-cn/请求书_数据源配置_保存预览.gif)

> **3. Action配置**

3.1 打开应用，选择"Action配置"，点击"新建"按钮。

![请求书_Action配置_新建](../_images/zh-cn/请求书_Action配置_新建.png)

3.2 设定信息：
- 模板名称选择【四. 设计器预览与保存】-> 步骤2中的模板。
- 功能设置中的按钮类型选择"详细信息页面按钮"。
- 使用功能部分勾选"显示预览内容"。
- 使用的功能选择"打印机打印"和"PDF下载"。
- 输入Apex类名信息。
- 打印设置中的"打印服务设置"可以选择为云打印服务或本地打印服务，"设备编号"设置为打印服务机器的机器码。

![请求书_Action配置_设定信息](../_images/zh-cn/请求书_Action配置_设定信息.png)

3.3 点击"保存"，系统将为您生成Apex Class和Visualforce Page的示例代码。

![请求书_Action配置_保存](../_images/zh-cn/请求书_Action配置_保存.png)

> **4. 创建Visualforce Page**

4.1 通过右侧的说明在Salesforce中创建新的Visualforce Page文件。

![请求书_创建VisualforcePage_创建VFPage](../_images/zh-cn/请求书_创建VisualforcePage_创建VFPage.gif)

> **5. 配置预览按钮**

5.1 在需要打印的Salesforce对象中添加按钮并且在对象页面中，确保按钮可见。

![请求书_配置预览按钮_创建](../_images/zh-cn/请求书_配置预览按钮_创建.gif)

5.2 在对象页面中，确保按钮可见。

![请求书_配置预览按钮_按钮可见](../_images/zh-cn/请求书_配置预览按钮_按钮可见.gif)

> **6. 预览与操作**

6.1 在业务对象的详细数据页面中，点击预览按钮，查看带有数据的模板预览，确保数据展示正确。

![请求书_预览与操作_预览](../_images/zh-cn/请求书_预览与操作_预览.gif)

6.2 点击"print"按钮，将模板连同数据一起打印（需确保已连接打印客户端）。
- <mark>**注意**</mark>：打印需要确保已经连接了打印客户端，如没有连接请参考[打印终端](download.md)

6.3 点击"PDF"按钮，将模板及数据导出为PDF文件。

![请求书_预览与操作_PDF](../_images/zh-cn/请求书_预览与操作_PDF.gif)